@model IEnumerable<Pharma.Models.Medicine>
@{
    ViewBag.Title = "Shop";
    ViewBag.Header = "Shop";
    Layout = "~/Views/Shared/User_Layout.cshtml";
}
<style>
    .vertical-scroll-container {
        max-height: 800px;
        overflow-y: auto;
    }

        .vertical-scroll-container::-webkit-scrollbar {
            width: 6px;
        }

        .vertical-scroll-container::-webkit-scrollbar-thumb {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }

    .row.no-gutters {
        margin-right: 0;
        margin-left: 0;
    }

        .row.no-gutters > [class^="col-"], .row.no-gutters > [class*=" col-"] {
            padding-right: 0;
            padding-left: 0;
        }

    .medicine-card {
        position: relative;
        width: 100%;
        max-width: 300px;
        margin: auto;
        overflow: hidden;
        border-radius: 0.5rem;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
    }

        .medicine-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .medicine-card .details {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            padding: 1rem;
            overflow-y: auto;
        }

        .medicine-card:hover .details {
            display: block;
        }

        .medicine-card .details h3 {
            font-size: 1.25rem;
            font-weight: bold;
        }

        .medicine-card .details p {
            margin: 0.5rem 0;
        }
</style>

<section class="px-2 py-32 bg-white md:px-0">
    <div class="container items-center max-w-6xl px-8 mx-auto xl:px-5">
        <h1 class="text-4xl font-extrabold tracking-tight text-gray-900 sm:text-5xl md:text-4xl lg:text-5xl xl:text-6xl">
            <span class="block xl:inline">Our Products</span>
        </h1>

        <!-- Search and Filter Section -->
        <div class="flex flex-wrap items-center justify-between mt-8">
            <div class="w-full md:w-1/2 flex">

                <form method="post" action="@Url.Action("ViewMedicines", "User")" class="w-full flex">
                    @Html.AntiForgeryToken()
                    <input type="text" name="searchTerm" placeholder="Search products..." class="w-full px-4 py-2 border rounded-l-md focus:outline-none focus:ring-2 focus:ring-indigo-600 focus:border-transparent">
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-r-md hover:bg-indigo-500 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a4 4 0 11-8 0 4 4 0 018 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.5 17.5l4.5 4.5" />
                        </svg>
                    </button>
                </form>


            </div>
            <div class="w-full mt-4 md:w-auto md:mt-0">
                <select class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-600 focus:border-transparent">
                    <option value="">Filter by Category</option>
                    <option value="category1">Category 1</option>
                    <option value="category2">Category 2</option>
                    <option value="category3">Category 3</option>
                </select>
            </div>
        </div>




        <div class="vertical-scroll-container mt-12 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
            @foreach (var medicine in Model)
            {
                <div class="medicine-card">
                    <img src="data:image/jpeg;base64,@Convert.ToBase64String(medicine.ImageData)" alt="@medicine.MedicineName">
                    <div class="p-5">
                        <h2 class="text-xl font-semibold text-gray-800">@medicine.MedicineName</h2>
                        <p class="mt-2 text-gray-600">@medicine.Manufacturer</p>
                        <div class="flex items-center justify-between mt-4">
                            <h3 class="text-lg font-semibold text-gray-800">$@medicine.Price</h3>
                        </div>
                    </div>
                    <div class="details">
                        <h3>@medicine.MedicineName</h3>
                        <p><strong>Generic Name:</strong> @medicine.GenericName</p>
                        <p><strong>Manufacturer:</strong> @medicine.Manufacturer</p>
                        <p><strong>Dosage Form:</strong> @medicine.DosageForm</p>
                        <p><strong>Strength:</strong> @medicine.Strength</p>
                        <p><strong>Quantity:</strong> @medicine.Quantity</p>
                        <p><strong>Price:</strong> $@medicine.Price</p>
                        <p><strong>Category:</strong> @medicine.Category</p>
                        @using (Html.BeginForm("AddToCart", "User", FormMethod.Post, new { @class = "add-to-cart-form" }))
                        {
                            @Html.AntiForgeryToken()
                            @Html.Hidden("medicineId", medicine.MedicineID)
                            <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-500">Add to Cart</button>
                        }
                    </div>
                </div>
            }

        </div>


        <!-- Vertical Scrollable Container with Grid Layout -->
        @*        <div class="vertical-scroll-container mt-12 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
                @foreach (var medicine in Model)
                {
                    <div class="medicine-card">
                        <img src="data:image/jpeg;base64,@Convert.ToBase64String(medicine.ImageData)" alt="@medicine.MedicineName">
                        <div class="p-5">
                            <h2 class="text-xl font-semibold text-gray-800">@medicine.MedicineName</h2>
                            <p class="mt-2 text-gray-600">@medicine.Manufacturer</p>
                            <div class="flex items-center justify-between mt-4">
                                <h3 class="text-lg font-semibold text-gray-800">$@medicine.Price</h3>
                            </div>
                        </div>
                        <div class="details">
                            <h3>@medicine.MedicineName</h3>
                            <p><strong>Generic Name:</strong> @medicine.GenericName</p>
                            <p><strong>Manufacturer:</strong> @medicine.Manufacturer</p>
                            <p><strong>Dosage Form:</strong> @medicine.DosageForm</p>
                            <p><strong>Strength:</strong> @medicine.Strength</p>
                            <p><strong>Quantity:</strong> @medicine.Quantity</p>
                            <p><strong>Price:</strong> $@medicine.Price</p>
                            <p><strong>Category:</strong> @medicine.Category</p>
                            @using (Html.BeginForm("AddToCart", "User", FormMethod.Post, new { @class = "add-to-cart-form" }))
                            {
                                @Html.AntiForgeryToken()
                                @Html.Hidden("medicineId", medicine.MedicineID)
                                <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-500">Add to Cart</button>
                            }
                        </div>
                    </div>
                }
            </div>*@
    </div>
</section>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
/*    $(document).ready(function () {
        $(".add-to-cart-form").submit(function (event) {
            event.preventDefault();
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                type: form.attr("method"),
                data: form.serialize(),
                success: function (response) {
                    alert("Medicine added to cart successfully!");
                },
                error: function (xhr, status, error) {
                    alert("Error adding medicine to cart.");
                }
            });
        });
    });*/

    $(document).ready(function () {
        // Comment this out for testing

        $(".add-to-cart-form").submit(function (event) {
            event.preventDefault();
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                type: form.attr("method"),
                data: form.serialize(),
                success: function (response) {
                    alert("Medicine added to cart successfully!");
                },
                error: function (xhr, status, error) {
                    alert("Error adding medicine to cart.");
                }
            });
        });

    });

</script>